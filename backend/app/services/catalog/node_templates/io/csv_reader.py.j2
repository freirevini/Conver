{# 
  CSV Reader Template
  Reads a CSV file into a pandas DataFrame
#}
def node_{{ node_id }}_csv_reader(
    {% if settings.file_path %}
    file_path: str = "{{ settings.file_path }}",
    {% else %}
    file_path: str = "{{ settings.url | default('input.csv') }}",
    {% endif %}
    *,
    {% if settings.delimiter %}
    delimiter: str = "{{ settings.delimiter | default(',') }}",
    {% else %}
    delimiter: str = ",",
    {% endif %}
    {% if settings.has_header is defined %}
    has_header: bool = {{ settings.has_header | lower }},
    {% else %}
    has_header: bool = True,
    {% endif %}
    {% if settings.skip_rows %}
    skip_rows: int = {{ settings.skip_rows }},
    {% else %}
    skip_rows: int = 0,
    {% endif %}
    {% if settings.encoding %}
    encoding: str = "{{ settings.encoding }}",
    {% else %}
    encoding: str = "utf-8",
    {% endif %}
) -> pd.DataFrame:
    """
    {{ node_name }}
    KNIME Node ID: {{ node_id }}
    Factory: {{ factory_class }}
    
    Reads CSV file into DataFrame.
    """
    logger.info(f"Reading CSV file: {file_path}")
    
    df = pd.read_csv(
        file_path,
        sep=delimiter,
        header=0 if has_header else None,
        skiprows=skip_rows,
        encoding=encoding,
    )
    
    logger.info(f"Loaded {len(df)} rows, {len(df.columns)} columns")
    return df
