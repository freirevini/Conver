{# 
  Joiner Template
  Joins two DataFrames on specified columns
#}
def node_{{ node_id }}_joiner(
    input_0: pd.DataFrame,
    input_1: pd.DataFrame,
    *,
    {% if settings.left_keys %}
    left_on: list = {{ settings.left_keys | tojson }},
    {% else %}
    left_on: list = None,
    {% endif %}
    {% if settings.right_keys %}
    right_on: list = {{ settings.right_keys | tojson }},
    {% else %}
    right_on: list = None,
    {% endif %}
    {% if settings.join_mode %}
    how: str = "{{ settings.join_mode | lower }}",
    {% else %}
    how: str = "inner",
    {% endif %}
    {% if settings.suffix_left %}
    suffix_left: str = "{{ settings.suffix_left }}",
    {% else %}
    suffix_left: str = "_left",
    {% endif %}
    {% if settings.suffix_right %}
    suffix_right: str = "{{ settings.suffix_right }}",
    {% else %}
    suffix_right: str = "_right",
    {% endif %}
) -> pd.DataFrame:
    """
    {{ node_name }}
    KNIME Node ID: {{ node_id }}
    Factory: {{ factory_class }}
    
    Joins two DataFrames on specified columns.
    """
    # Normalize join type
    join_map = {
        "inner": "inner",
        "left": "left",
        "left outer": "left",
        "right": "right", 
        "right outer": "right",
        "full": "outer",
        "full outer": "outer",
        "outer": "outer",
    }
    how_normalized = join_map.get(how.lower(), "inner")
    
    # Handle join keys
    if left_on and right_on:
        df = input_0.merge(
            input_1,
            left_on=left_on,
            right_on=right_on,
            how=how_normalized,
            suffixes=(suffix_left, suffix_right),
        )
    elif left_on:
        # Same column names
        df = input_0.merge(
            input_1,
            on=left_on,
            how=how_normalized,
            suffixes=(suffix_left, suffix_right),
        )
    else:
        # Try to find common columns
        common_cols = list(set(input_0.columns) & set(input_1.columns))
        if common_cols:
            df = input_0.merge(
                input_1,
                on=common_cols,
                how=how_normalized,
                suffixes=(suffix_left, suffix_right),
            )
        else:
            # Cross join as fallback
            logger.warning("No join keys found, performing cross join")
            df = input_0.merge(input_1, how="cross")
    
    logger.debug(f"Joined: {len(input_0)} x {len(input_1)} -> {len(df)} rows")
    return df
