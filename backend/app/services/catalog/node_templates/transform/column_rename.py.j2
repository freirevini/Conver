{# 
  Column Rename Template
  Renames columns in a DataFrame
#}
def node_{{ node_id }}_column_rename(
    input_0: pd.DataFrame,
    *,
    {% if settings.rename_map %}
    rename_map: dict = {{ settings.rename_map | tojson }},
    {% else %}
    rename_map: dict = {},
    {% endif %}
) -> pd.DataFrame:
    """
    {{ node_name }}
    KNIME Node ID: {{ node_id }}
    Factory: {{ factory_class }}
    
    Renames columns in DataFrame.
    """
    df = input_0.copy()
    
    if rename_map:
        # Only rename columns that exist
        valid_rename = {k: v for k, v in rename_map.items() if k in df.columns}
        df = df.rename(columns=valid_rename)
        
        if len(valid_rename) != len(rename_map):
            missing = set(rename_map.keys()) - set(valid_rename.keys())
            logger.warning(f"Columns not found for rename: {missing}")
    
    return df
